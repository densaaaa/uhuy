<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Hitungan Mundur 3-2-1 â€” Reveal Dramatis</title>
  <style>
    :root{
      --bg:#0b0f14;
      --accent:#ff2d55;
      --accent2:#00e6a8;
      --glass: rgba(255,255,255,0.06);
    }
    html,body{height:100%;}
    body{
      margin:0;
      font-family: "Poppins", system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
      background: radial-gradient(1200px 600px at 10% 10%, rgba(255,45,85,0.04), transparent),
                  radial-gradient(800px 400px at 90% 90%, rgba(0,230,168,0.03), transparent),
                  var(--bg);
      color:#fff;
      display:flex;
      align-items:center;
      justify-content:center;
      overflow:hidden;
    }

    /* Container utama */
    .stage{
      width:100%;
      max-width:1000px;
      height:640px;
      background: linear-gradient(180deg, rgba(255,255,255,0.02), transparent);
      border-radius:16px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.7);
      position:relative;
      overflow:hidden;
      display:grid;
      place-items:center;
    }

    /* Layar hitungan mundur */
    .counter{
      font-size:180px;
      font-weight:900;
      letter-spacing:6px;
      text-align:center;
      width:100%;
      transform-origin:center;
      text-shadow: 0 6px 30px rgba(0,0,0,0.8), 0 0 40px rgba(255,45,85,0.06);
      pointer-events:none;
    }

    /* Efek besar saat angka muncul */
    .tick{
      opacity:0;
      transform: scale(0.6) rotate(-6deg);
      transition: transform 0.45s cubic-bezier(.22,.9,.33,1), opacity 0.25s;
      filter: drop-shadow(0 20px 30px rgba(0,0,0,0.7));
    }
    .tick.active{
      opacity:1;
      transform: scale(1.03) rotate(0deg);
      animation: pulse 0.7s ease-out 1;
    }

    @keyframes pulse{
      0%{transform:scale(0.9) rotate(-3deg); filter:blur(0);} 
      50%{transform:scale(1.12) rotate(2deg);}
      100%{transform:scale(1) rotate(0deg);}
    }

    /* Glitch visual pada teks (subtle) */
    .tick.active::before, .tick.active::after{
      content:attr(data-number);
      position:absolute;
      left:0; right:0; top:0; bottom:0;
      opacity:0.25;
      mix-blend-mode:screen;
    }
    .tick.active::before{ transform:translateX(-6px); color:var(--accent); clip-path: inset(0 0 40% 0);} 
    .tick.active::after{ transform:translateX(6px); color:var(--accent2); clip-path: inset(40% 0 0 0);} 

    /* Area reveal gambar */
    .reveal-wrap{
      position:absolute; inset:0; display:flex; align-items:center; justify-content:center; pointer-events:none;
    }
    .reveal{
      width:75%; max-width:720px; height:420px; border-radius:12px; overflow:hidden; transform:scale(0.9);
      transition: transform 1s cubic-bezier(.2,.9,.3,1), opacity 0.7s; opacity:0;
      box-shadow: 0 20px 60px rgba(0,0,0,0.6), inset 0 0 60px rgba(0,0,0,0.35);
      position:relative;
      background:linear-gradient(180deg, rgba(0,0,0,0.25), rgba(0,0,0,0.45));
      border:1px solid rgba(255,255,255,0.03);
    }
    .reveal.show{ opacity:1; transform:scale(1); }

    .reveal img{
      width:100%; height:100%; object-fit:cover; display:block; transform:scale(1.08);
      transition: transform 1s ease, filter 0.8s ease;
      filter: saturate(0.6) contrast(1.2) brightness(0.9) blur(0.4px);
    }
    .reveal.show img{ transform:scale(1); filter: saturate(1.3) contrast(1.25) brightness(1.03) blur(0px);} 

    /* Overlay dramatic effects */
    .overlay-flash{
      position:absolute; inset:0; pointer-events:none; mix-blend-mode:screen; opacity:0; transition:opacity 0.2s;
    }
    .overlay-flash.on{ opacity:1; background: radial-gradient(circle at 20% 30%, rgba(255,255,255,0.22), transparent 10%), linear-gradient(90deg, rgba(255,45,85,0.06), rgba(0,230,168,0.06)); }

    /* Scanlines */
    .scanlines{position:absolute; inset:0; background-image: linear-gradient(rgba(255,255,255,0.02) 1px, transparent 1px); background-size:100% 6px; opacity:0.12; mix-blend-mode:overlay;}

    /* Glitch pseudo elements for reveal */
    .reveal::before, .reveal::after{
      content:''; position:absolute; inset:0; pointer-events:none; mix-blend-mode:screen; opacity:0; transition:opacity 0.5s;
    }
    .reveal::before{ background: linear-gradient(90deg, rgba(255,45,85,0.06), transparent); }
    .reveal::after{ background: linear-gradient(90deg, rgba(0,230,168,0.04), transparent); }
    .reveal.show::before, .reveal.show::after{ opacity:1; }

    /* Small shaking effect */
    .shake{ animation: shake 0.9s cubic-bezier(.36,.07,.19,.97) both; }
    @keyframes shake{
      0%{transform:translate(0,0) rotate(0);} 20%{transform:translate(-6px,3px) rotate(-1deg);} 40%{transform:translate(6px,-3px) rotate(1deg);} 60%{transform:translate(-3px,2px);} 80%{transform:translate(2px,-1px);} 100%{transform:translate(0,0) rotate(0);} 
    }

    /* Tombol replay */
    .controls{ position:absolute; bottom:18px; right:18px; z-index:80; }
    .btn{
      background:var(--glass); border:1px solid rgba(255,255,255,0.06); color:#fff; padding:10px 14px; border-radius:10px; cursor:pointer; font-weight:600; backdrop-filter: blur(6px);
    }

    /* Petunjuk kecil */
    .hint{ position:absolute; top:14px; left:18px; font-size:14px; opacity:0.7; }

    /* Responsive kecil */
    @media (max-width:640px){
      .stage{ height:86vh; }
      .counter{ font-size:96px; }
      .reveal{ width:90%; height:46vh; }
    }
  </style>
</head>
<body>
  <div class="stage">
    <div class="hint">CIHUY</div>
    <div id="counter" class="counter" aria-live="polite"></div>

    <div class="reveal-wrap">
      <div id="reveal" class="reveal" role="img" aria-label="Gambar yang muncul setelah hitungan mundur">
        <!-- Ganti src di bawah dengan gambar Anda -->
        <img id="revealImg" src="WhatsApp Image 2025-11-25 at 16.37.34.jpeg" />
        <div class="scanlines"></div>
      </div>
      <div id="flash" class="overlay-flash"></div>
    </div>

    <canvas id="particles" width="800" height="400" style="position:absolute; inset:0; pointer-events:none;"></canvas>

    <div class="controls">
      <button id="replay" class="btn">PENCET</button>
    </div>
  </div>

  <script>
    // ====== Setup audio (beep + rumble) menggunakan WebAudio ======
    const AudioCtx = window.AudioContext || window.webkitAudioContext;
    const ctx = new AudioCtx();

    function beep(time, freq=880, dur=0.14, vol=0.15) {
      const o = ctx.createOscillator();
      const g = ctx.createGain();
      o.type = 'sine'; o.frequency.value = freq;
      g.gain.value = vol;
      o.connect(g); g.connect(ctx.destination);
      o.start(time);
      o.stop(time + dur);
    }

    function rumble(time, dur=0.9){
      const o = ctx.createOscillator(); const g = ctx.createGain();
      o.type = 'sawtooth'; o.frequency.value = 60;
      const lfo = ctx.createOscillator(); const lfoGain = ctx.createGain();
      lfo.frequency.value = 6; lfoGain.gain.value = 20; lfo.connect(lfoGain); lfoGain.connect(o.frequency);
      g.gain.value = 0.6;
      o.connect(g); g.connect(ctx.destination);
      lfo.start(time); o.start(time);
      o.stop(time + dur); lfo.stop(time + dur);
    }

    // ====== Countdown logic ======
    const counterEl = document.getElementById('counter');
    const revealEl = document.getElementById('reveal');
    const flash = document.getElementById('flash');
    const replayBtn = document.getElementById('replay');
    const particlesCanvas = document.getElementById('particles');
    const pc = particlesCanvas.getContext('2d');

    let particles = [];

    function emitBurst(x,y, color){
      for(let i=0;i<50;i++){
        particles.push({
          x:x, y:y,
          vx:(Math.random()-0.5)*8, vy:(Math.random()-0.8)*8,
          life: Math.random()*1.2 + 0.6,
          age:0,
          size: Math.random()*3 + 1,
          color: color
        });
      }
    }

    function drawParticles(dt){
      pc.clearRect(0,0,particlesCanvas.width,particlesCanvas.height);
      pc.save(); pc.globalCompositeOperation='lighter';
      for(let p of particles){
        p.x += p.vx * dt; p.y += p.vy * dt; p.vy += 9.8 * dt * 0.3; p.age += dt;
        const lifeRatio = 1 - p.age / p.life;
        if(lifeRatio <= 0) continue;
        pc.globalAlpha = Math.max(0, lifeRatio);
        pc.fillStyle = p.color;
        pc.beginPath(); pc.arc(p.x, p.y, p.size * lifeRatio * 1.6, 0, Math.PI*2); pc.fill();
      }
      pc.restore();
      particles = particles.filter(p => p.age < p.life);
    }

    // resize canvas to stage
    function fitCanvas(){
      const rect = document.querySelector('.stage').getBoundingClientRect();
      particlesCanvas.width = rect.width; particlesCanvas.height = rect.height;
    }
    window.addEventListener('resize', fitCanvas);
    fitCanvas();

    // main animate loop for particles
    let last = performance.now();
    function loop(now){
      const dt = (now - last)/1000; last = now;
      drawParticles(dt);
      requestAnimationFrame(loop);
    }
    requestAnimationFrame(loop);

    function showNumber(n){
      counterEl.innerHTML = '';
      const span = document.createElement('div');
      span.className = 'tick';
      span.setAttribute('data-number', n);
      span.textContent = n;
      counterEl.appendChild(span);
      // force reflow then active
      void span.offsetWidth;
      span.classList.add('active');
      // small glitch sound
      const now = ctx.currentTime;
      beep(now, 220 + (3-n)*120, 0.12, 0.18);

      // short flash for '3' and '1'
      if(n===3 || n===1){
        flash.classList.add('on'); setTimeout(()=>flash.classList.remove('on'),120);
      }

      // remove after time
      setTimeout(()=>{ span.classList.remove('active'); span.remove(); }, 700);
    }

    function revealImage(){
      // play rumble + final chord
      const now = ctx.currentTime;
      rumble(now, 1.0);
      beep(now+0.05, 440, 0.25, 0.24);
      beep(now+0.27, 660, 0.14, 0.18);

      // visual show
      revealEl.classList.add('show','shake');
      setTimeout(()=> revealEl.classList.remove('shake'), 900);

      // overlay flash
      flash.classList.add('on'); setTimeout(()=>flash.classList.remove('on'), 220);

      // emit particle bursts from center (2 colors)
      const rect = revealEl.getBoundingClientRect();
      const cx = rect.left + rect.width/2 - particlesCanvas.getBoundingClientRect().left;
      const cy = rect.top + rect.height/2 - particlesCanvas.getBoundingClientRect().top;
      emitBurst(cx, cy, 'rgba(255,45,85,0.95)');
      emitBurst(cx, cy, 'rgba(0,230,168,0.95)');

      // small periodic glitch flicker
      let flick = 0;
      const int = setInterval(()=>{
        revealEl.classList.toggle('shake');
        revealEl.style.transform = 'scale(' + (1 + 0.02*Math.random()) + ')';
        flick++; if(flick>6){ clearInterval(int); revealEl.style.transform = ''; }
      }, 120);
    }

    // Run the 3-2-1 -> reveal sequence
    function runSequence(){
      // resume audio context on user interaction (Chrome requirement)
      if(ctx.state === 'suspended') ctx.resume();

      // reset
      revealEl.classList.remove('show'); flash.classList.remove('on'); particles = [];
      // small timeline
      const numbers = [3,2,1];
      let t = 0;
      for(let i=0;i<numbers.length;i++){
        ((num,delay)=>{
          setTimeout(()=> showNumber(num), delay);
        })(numbers[i], t);
        t += 800; // 0.8s interval
      }
      // final reveal slightly after the last number
      setTimeout(()=> revealImage(), t + 220);
    }

    // replay button
    replayBtn.addEventListener('click', ()=>{ runSequence(); });

    // start immediately
    window.addEventListener('load', ()=>{ setTimeout(runSequence, 350); });
  </script>
</body>
</html>
